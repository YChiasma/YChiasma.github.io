<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Firebase Email/Password Auth — Example</title>
  <style>
    :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial;margin:0}
    body{padding:24px;background:#f5f7fb;color:#111}
    .card{max-width:720px;margin:18px auto;padding:20px;background:#fff;border-radius:12px;box-shadow:0 6px 18px rgba(20,20,40,0.06)}
    h1{margin:0 0 12px;font-size:20px}
    form{display:grid;gap:10px;margin-bottom:12px}
    input{padding:10px;border:1px solid #d6d9e6;border-radius:8px;font-size:14px}
    button{padding:10px 12px;border-radius:8px;border:0;background:#2563eb;color:#fff;font-weight:600;cursor:pointer}
    button.ghost{background:transparent;color:#2563eb;border:1px solid #d6d9e6}
    .row{display:flex;gap:10px}
    .muted{color:#6b7280;font-size:13px}
    pre{background:#0f1724;color:#d1fae5;padding:8px;border-radius:6px;overflow:auto}
    .error{color:#b91c1c}
    .success{color:#065f46}
    .user-box{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:8px;border:1px dashed #e6eefc}
  </style>
</head>
<body>
  <div class="card">
    <h1>Firebase Email + Password Authentication</h1>
    <p class="muted">A minimal single-file example. Replace the <code>firebaseConfig</code> object with your project values and enable Email/Password sign-in in the Firebase console.</p>

    <!-- Sign up form -->
    <section id="signup">
      <h2 style="font-size:16px;margin-top:6px">Create account</h2>
      <form id="signup-form">
        <input id="signup-email" type="email" placeholder="Email" required />
        <input id="signup-password" type="password" placeholder="Password (6+ chars)" minlength="6" required />
        <div class="row">
          <button type="submit">Create account</button>
          <button type="button" id="signup-anon" class="ghost">Create anonymous</button>
        </div>
        <div id="signup-msg" aria-live="polite"></div>
      </form>
    </section>

    <hr />

    <!-- Sign in form -->
    <section id="signin">
      <h2 style="font-size:16px;margin-top:6px">Sign in</h2>
      <form id="signin-form">
        <input id="signin-email" type="email" placeholder="Email" required />
        <input id="signin-password" type="password" placeholder="Password" required />
        <div class="row">
          <button type="submit">Sign in</button>
          <button type="button" id="send-reset" class="ghost">Send password reset</button>
        </div>
        <div id="signin-msg" aria-live="polite"></div>
      </form>
    </section>

    <hr />

    <!-- User info & sign out -->
    <section>
      <h2 style="font-size:16px;margin-top:6px">Current user</h2>
      <div id="user-area">
        <div class="muted">Not signed in.</div>
      </div>
      <div style="margin-top:10px">
        <button id="signout-btn" class="ghost" style="display:none">Sign out</button>
      </div>
    </section>

    <hr />

    <section>
      <h2 style="font-size:16px;margin-top:6px">Notes</h2>
      <ul class="muted">
        <li>Enable <strong>Email/Password</strong> sign-in in Firebase Console → Authentication → Sign-in method.</li>
        <li>Replace <code>firebaseConfig</code> with your project's config (apiKey, authDomain, ...).</li>
        <li>This example uses the <strong>modular</strong> Firebase Web SDK (v9+).</li>
      </ul>
    </section>
  </div>

  <!-- Firebase + app code -->
  <script type="module">
    // IMPORTANT: replace these values with your project's config
    // You can get this from Firebase Console -> Project settings -> Your apps -> SDK setup and config
    const firebaseConfig = {
      apiKey: "AIzaSyAtlpMxWZ75kX_0c_SooL8lzeFXqOhAZgc",
      authDomain: "streak-eda1a.firebaseapp.com",
      projectId: "streak-eda1a",
      // ... other optional fields
      // other fields... are these optional?
      storageBucket: "streak-eda1a.firebasestorage.app",
      messagingSenderId: "680263289782",
      appId: "1:680263289782:web:ee2253c964ff1cfe2e4f17"
    };

    // Import the modular SDK directly from CDN
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js';
    import {
      getAuth,
      createUserWithEmailAndPassword,
      signInWithEmailAndPassword,
      signOut,
      onAuthStateChanged,
      sendPasswordResetEmail,
      signInAnonymously
    } from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js';

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // --- UI elements ---
    const signupForm = document.getElementById('signup-form');
    const signupEmail = document.getElementById('signup-email');
    const signupPassword = document.getElementById('signup-password');
    const signupMsg = document.getElementById('signup-msg');
    const signupAnonBtn = document.getElementById('signup-anon');

    const signinForm = document.getElementById('signin-form');
    const signinEmail = document.getElementById('signin-email');
    const signinPassword = document.getElementById('signin-password');
    const signinMsg = document.getElementById('signin-msg');
    const sendResetBtn = document.getElementById('send-reset');

    const userArea = document.getElementById('user-area');
    const signoutBtn = document.getElementById('signout-btn');

    // Utility: show message
    function showMessage(el, text, type=''){
      el.textContent = text;
      el.className = type === 'error' ? 'error' : (type === 'success' ? 'success' : 'muted');
    }

    // Create account
    signupForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      showMessage(signupMsg, 'Creating account...', '');
      try{
        const { user } = await createUserWithEmailAndPassword(auth, signupEmail.value.trim(), signupPassword.value);
        showMessage(signupMsg, `Account created — UID: ${user.uid}`, 'success');
      } catch(err){
        showMessage(signupMsg, `Error: ${err.message}`, 'error');
      }
    });

    // Create anonymous account (optional)
    signupAnonBtn.addEventListener('click', async () => {
      showMessage(signupMsg, 'Creating anonymous session...', '');
      try{
        const res = await signInAnonymously(auth);
        showMessage(signupMsg, `Signed in anonymously — UID: ${res.user.uid}`, 'success');
      } catch(err){
        showMessage(signupMsg, `Error: ${err.message}`, 'error');
      }
    });

    // Sign in
    signinForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      showMessage(signinMsg, 'Signing in...', '');
      try{
        const { user } = await signInWithEmailAndPassword(auth, signinEmail.value.trim(), signinPassword.value);
        showMessage(signinMsg, `Signed in — UID: ${user.uid}`, 'success');
      } catch(err){
        showMessage(signinMsg, `Error: ${err.message}`, 'error');
      }
    });

    // Send password reset
    sendResetBtn.addEventListener('click', async () => {
      const email = signinEmail.value.trim();
      if(!email){
        showMessage(signinMsg, 'Enter your email in the Sign in form first.', 'error');
        return;
      }
      showMessage(signinMsg, 'Sending password reset email...', '');
      try{
        await sendPasswordResetEmail(auth, email);
        showMessage(signinMsg, 'Password reset email sent. Check your inbox.', 'success');
      } catch(err){
        showMessage(signinMsg, `Error: ${err.message}`, 'error');
      }
    });

    // Sign out
    signoutBtn.addEventListener('click', async () => {
      try{
        await signOut(auth);
        showMessage(userArea, 'Signed out.', 'muted');
      } catch(err){
        showMessage(userArea, `Error signing out: ${err.message}`, 'error');
      }
    });

    // Listen for auth state changes
    onAuthStateChanged(auth, (user) => {
      if(user){
        const isAnon = user.isAnonymous;
        userArea.innerHTML = `\n          <div class="user-box">\n            <div>\n              <div><strong>UID:</strong> ${user.uid}</div>\n              <div><strong>Email:</strong> ${user.email ?? '(none — anonymous)'} </div>\n              <div class="muted">${isAnon ? 'Signed in anonymously' : 'Signed in with email'}</div>\n            </div>\n            <div style="text-align:right">\n              <div class="muted">Provider: ${user.providerData.length ? user.providerData.map(p=>p.providerId).join(', ') : 'none'}</div>\n            </div>\n          </div>\n        `;
        document.getElementById("signup-form").style.display = "none";
        document.getElementById("signin-form").style.display = "none";
        signoutBtn.style.display = 'inline-block';
      } else {
        userArea.innerHTML = '<div class="muted">Not signed in.</div>';
        signoutBtn.style.display = 'none';
        document.getElementById("signup-form").style.display = "block";
        document.getElementById("signin-form").style.display = "block";
      }
    });

  </script>
</body>
</html>
